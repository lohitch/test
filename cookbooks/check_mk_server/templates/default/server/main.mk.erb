# Generated by Chef for <%= node[:platform] %>

all_hosts += [
<% @nodes.each do |row| -%>
  '<%= row['hostname'] %>|<%= row['os'] %>',
<% end -%>
]

ipaddresses = {
<% @nodes.each do |row| -%>
  "<%= row['hostname'] %>" : "<%= row['ipaddress'] %>",
<% end -%>
}

define_hostgroups = {
  ## OS group
  "WINDOWS"    : "Windows Servers",
  "LINUX"      : "Linux Servers",
  "UBUNTU"     : "Ubuntu Servers",
  "CENTOS"     : "CentOs Servers",
  "PRODUCTION" : "Prod Server",
  "DEV"        : "Dev Server",
  "DB"         : "DB Server",
  "APP"        : "APP Servers",
  "WEB"        : "WEB Server",
}

host_groups += [
  ## OS type ###########
  ( 'WINDOWS', ['WINDOWS'], ALL_HOSTS ),
  ( 'LINUX', ['LINUX'], ALL_HOSTS, ),
  ( 'UBUNTU', ['UBUNTU'], ALL_HOSTS, ),
  ( 'CENTOS', ['CENTOS'], ALL_HOSTS, ),
  ( 'PRODUCTION', ['PRODUCTION'], ALL_HOSTS, ),
  ( 'DEV', ['DEV'], ALL_HOSTS, ),
  ( 'DB', ['DB'], ALL_HOSTS, ),
  ( 'APP', ['APP'], ALL_HOSTS, ),
  ( 'WEB', ['WEB'], ALL_HOSTS, ),
]

define_servicegroups = {
  "SYSTEM"  :  "System Checks",
}

service_groups += [
  ("SYSTEM", ALL_HOSTS, ["Uptime$","CPU load","Memory used","fs_/$","NIC.*.link","Disk IO SUMMARY","Disk IO read","Disk IO write","Check_MK",]),
]

# AWS ICMP shutup...
host_check_commands += [
  ( ("tcp", "<%= @agent_port %>"), ALL_HOSTS ),
]

# performance data format
perfdata_format = "pnp"

define_servicegroups  = True
define_hostgroups = True
